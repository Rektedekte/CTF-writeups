<!doctype html>
<html>
    <head>
        <meta charset="UTF-8">
        <title>Writeups</title>
        <link rel="stylesheet" href="/CTF-writeups/static/css/markdown.css">
        <link rel="stylesheet" href="/CTF-writeups/static/css/base.css">
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro" rel="stylesheet">
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS_HTML-full"></script>
        <script type="text/x-mathjax-config">
            MathJax.Hub.Config({
                tex2jax: {
                    inlineMath: [["$", "$"], ["\\\\(", "\\\\)"]],
                    displayMath: [["$$", "$$"], ["\\[", "\\]"]],
                    processEscapes: true
                },
                config: ["MMLorHTML.js"],
                jax: ["input/TeX", "output/HTML-CSS", "output/NativeMML"],
                extensions: ["MathMenu.js", "MathZoom.js"]
            });
        </script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>
        <script type="text/javascript" src="/CTF-writeups/static/js/scrypt.js"></script>
        <script type="text/javascript" src="/CTF-writeups/static/js/aesjs.js"></script>
    </head>
    <body>
        <div id="navbar">
            <a href="/CTF-writeups" id="root-link">
                <h2>Rektedekte</h2>
            </a>
            <ul id="nav-links">
				<li><a href="/CTF-writeups/search" class="no-flash">
					<img src="/CTF-writeups/static/img/search-icon.png" alt="Search icon" class="icon">
				</a></li>
                <li><a href="https://github.com/Rektedekte" class="no-flash" target=”_blank”>
                    <img src="/CTF-writeups/static/img/github-icon.png" alt="Github icon" class="icon">
                </a></li>
                <li><a href="https://discordapp.com/users/277155307678072832" class="no-flash" target=”_blank”>
                    <img src="/CTF-writeups/static/img/discord-icon.png" alt="Discord icon" class="icon">
                </a></li>
                <li><a href="https://app.hackthebox.com/users/1052687" class="no-flash" target=”_blank”>
                    <img src="/CTF-writeups/static/img/hackthebox-icon.png" alt="Hackthebox icon" class="icon">
                </a></li>
            </ul>
        </div>
        
    <div id="content">
        <h3>
            <a href="/CTF-writeups\Gymnasie-mesterskaberne 2022">Gymnasie-mesterskaberne 2022</a>
            <a href="/CTF-writeups\Gymnasie-mesterskaberne 2022\Snake Whisperer/files.zip" class="text-right">Download</a>
        </h3>
        <h1>
            <span>Snake Whisperer</span>
            <span class="text-right">[None]</span>
        </h1>
        <hr class="no-space">
        
            
    <div class="tags">
        
            
                <a href="/CTF-writeups/search?q=misc" class="tag">misc </a>
            
        
    </div>

        
        
            <div id="markdown">
                <p><code>*CHALL TEXT*</code></p>
<p>In this challenge, we are given a pygame replica of the game snake. In order to complete the challenge, we must submit the correct token to <em>PLACEHOLDER</em> in order to get the flag. Let's dive into the source code:</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Import the pygame module</span>
<span class="kn">from</span> <span class="nn">enum</span> <span class="kn">import</span> <span class="n">Enum</span>
<span class="kn">import</span> <span class="nn">pygame</span>
<span class="kn">import</span> <span class="nn">base64</span>
<span class="c1"># Import pygame.locals for easier access to key coordinates</span>
<span class="c1"># Updated to conform to flake8 and black standards</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">from</span> <span class="nn">pygame.locals</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">RLEACCEL</span><span class="p">,</span>
    <span class="n">K_UP</span><span class="p">,</span>
    <span class="n">K_DOWN</span><span class="p">,</span>
    <span class="n">K_LEFT</span><span class="p">,</span>
    <span class="n">K_RIGHT</span><span class="p">,</span>
    <span class="n">K_ESCAPE</span><span class="p">,</span>
    <span class="n">KEYDOWN</span><span class="p">,</span>
    <span class="n">QUIT</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1">#Initialize setup for sounds. Defaults are fine. If we want to change defaults we must call this before pygame.init</span>
<span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
<span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">set_caption</span><span class="p">(</span><span class="s2">&quot;Snek&quot;</span><span class="p">)</span>

<span class="c1">#Apple made by Kira_Justine20</span>
<span class="c1"># Initialize pygame</span>
<span class="n">pygame</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
<span class="n">SCREEN_WIDTH</span> <span class="o">=</span> <span class="mi">800</span>
<span class="n">SCREEN_HEIGHT</span> <span class="o">=</span> <span class="mi">600</span>
<span class="n">bounds</span> <span class="o">=</span> <span class="p">(</span><span class="n">SCREEN_WIDTH</span><span class="p">,</span><span class="n">SCREEN_HEIGHT</span><span class="p">)</span>
<span class="n">window</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">set_mode</span><span class="p">(</span><span class="n">bounds</span><span class="p">)</span>
<span class="c1">#Load and play background music</span>
<span class="c1">#Made by bsp7176 from https://freesound.org/people/bsp7176/sounds/570634/</span>
<span class="c1"># License: https://creativecommons.org/licenses/by/3.0/</span>
<span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">music</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;snakeMusic.mp3&quot;</span><span class="p">)</span>
<span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">music</span><span class="o">.</span><span class="n">play</span><span class="p">(</span><span class="n">loops</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">spaceLevel</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;space.jpg&quot;</span><span class="p">)</span><span class="c1">#Rawdanitsu https://opengameart.org/content/space-backgrounds-1</span>
<span class="n">jungleLevel</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;forest.png&quot;</span><span class="p">)</span><span class="c1">#ramtam https://opengameart.org/content/forest-background-art-2</span>
<span class="n">waterLevel</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;water.png&quot;</span><span class="p">)</span><span class="c1">#Alucard https://opengameart.org/content/2d-background-underwater</span>
<span class="n">victoryImage</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;victory.png&quot;</span><span class="p">)</span><span class="c1">#bevouliin.com https://opengameart.org/content/golden-trophy-game-ornament</span>
<span class="n">backgrounds</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">backgrounds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spaceLevel</span><span class="p">)</span>
<span class="n">backgrounds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">jungleLevel</span><span class="p">)</span>
<span class="n">backgrounds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">waterLevel</span><span class="p">)</span>
<span class="c1">#Load all sound files</span>

<span class="n">snakeMoveSound</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">Sound</span><span class="p">(</span><span class="s2">&quot;snakeMove.mp3&quot;</span><span class="p">)</span> <span class="c1">#Sound sources: bsp7176</span>
<span class="n">snakeEatFoodSound</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">Sound</span><span class="p">(</span><span class="s2">&quot;snakeEatFood2.mp3&quot;</span><span class="p">)</span><span class="c1">#aruscio28</span>
<span class="n">snekDeathSound</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">Sound</span><span class="p">(</span><span class="s2">&quot;oof.mp3&quot;</span><span class="p">)</span><span class="c1">#Kayrabey07</span>
<span class="n">victorySound</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">Sound</span><span class="p">(</span><span class="s2">&quot;victorySound.mp3&quot;</span><span class="p">)</span><span class="c1">#Walid</span>

<span class="n">snakeSpeed</span> <span class="o">=</span> <span class="mi">15</span>
<span class="k">def</span> <span class="nf">loadSecretTextFileBETA</span><span class="p">(</span><span class="n">level</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">filePointer</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;./secretScoreBETASKIP.txt&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ruhRoh</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;File likely not found.&quot;</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="n">secretCode</span> <span class="o">=</span> <span class="n">filePointer</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
    <span class="c1"># print(secretCode)</span>
    <span class="n">level</span><span class="o">.</span><span class="n">verifyLevelCode</span><span class="p">(</span><span class="n">secretCode</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">Direction</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
  <span class="n">UP</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="n">DOWN</span> <span class="o">=</span> <span class="mi">1</span>
  <span class="n">LEFT</span> <span class="o">=</span> <span class="mi">2</span>
  <span class="n">RIGHT</span> <span class="o">=</span> <span class="mi">3</span>

<span class="k">class</span> <span class="nc">Snake</span><span class="p">():</span>
    <span class="n">length</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">direction</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">body</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">block_size</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">color</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">255</span><span class="p">)</span>
    <span class="n">bounds</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">block_size</span><span class="p">,</span> <span class="n">bounds</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">block_size</span> <span class="o">=</span> <span class="n">block_size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bounds</span> <span class="o">=</span> <span class="n">bounds</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">respawn</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">respawn</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="mi">3</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">body</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">),(</span><span class="mi">20</span><span class="p">,</span><span class="mi">40</span><span class="p">),(</span><span class="mi">20</span><span class="p">,</span><span class="mi">60</span><span class="p">)]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">direction</span> <span class="o">=</span> <span class="n">Direction</span><span class="o">.</span><span class="n">RIGHT</span>
    <span class="k">def</span> <span class="nf">draw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">game</span><span class="p">,</span> <span class="n">window</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">segment</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">body</span><span class="p">:</span>
            <span class="n">game</span><span class="o">.</span><span class="n">draw</span><span class="o">.</span><span class="n">rect</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">color</span><span class="p">,</span> <span class="p">(</span><span class="n">segment</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">segment</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">block_size</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">block_size</span><span class="p">))</span>
    <span class="k">def</span> <span class="nf">move</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">current_head</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">direction</span> <span class="o">==</span> <span class="n">Direction</span><span class="o">.</span><span class="n">DOWN</span><span class="p">:</span>
            <span class="n">next_head</span> <span class="o">=</span> <span class="p">(</span><span class="n">current_head</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">current_head</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">block_size</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">next_head</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">direction</span> <span class="o">==</span> <span class="n">Direction</span><span class="o">.</span><span class="n">UP</span><span class="p">:</span>
            <span class="n">next_head</span> <span class="o">=</span> <span class="p">(</span><span class="n">current_head</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">current_head</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">block_size</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">next_head</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">direction</span> <span class="o">==</span> <span class="n">Direction</span><span class="o">.</span><span class="n">RIGHT</span><span class="p">:</span>
            <span class="n">next_head</span> <span class="o">=</span> <span class="p">(</span><span class="n">current_head</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">block_size</span><span class="p">,</span> <span class="n">current_head</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">next_head</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">direction</span> <span class="o">==</span> <span class="n">Direction</span><span class="o">.</span><span class="n">LEFT</span><span class="p">:</span>
            <span class="n">next_head</span> <span class="o">=</span> <span class="p">(</span><span class="n">current_head</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">block_size</span><span class="p">,</span> <span class="n">current_head</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">next_head</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">body</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">steer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">direction</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">direction</span> <span class="o">==</span> <span class="n">Direction</span><span class="o">.</span><span class="n">DOWN</span> <span class="ow">and</span> <span class="n">direction</span> <span class="o">!=</span> <span class="n">Direction</span><span class="o">.</span><span class="n">UP</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">direction</span> <span class="o">=</span> <span class="n">direction</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">direction</span> <span class="o">==</span> <span class="n">Direction</span><span class="o">.</span><span class="n">UP</span> <span class="ow">and</span> <span class="n">direction</span> <span class="o">!=</span> <span class="n">Direction</span><span class="o">.</span><span class="n">DOWN</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">direction</span> <span class="o">=</span> <span class="n">direction</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">direction</span> <span class="o">==</span> <span class="n">Direction</span><span class="o">.</span><span class="n">LEFT</span> <span class="ow">and</span> <span class="n">direction</span> <span class="o">!=</span> <span class="n">Direction</span><span class="o">.</span><span class="n">RIGHT</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">direction</span> <span class="o">=</span> <span class="n">direction</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">direction</span> <span class="o">==</span> <span class="n">Direction</span><span class="o">.</span><span class="n">RIGHT</span> <span class="ow">and</span> <span class="n">direction</span> <span class="o">!=</span> <span class="n">Direction</span><span class="o">.</span><span class="n">LEFT</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">direction</span> <span class="o">=</span> <span class="n">direction</span>
    <span class="k">def</span> <span class="nf">eat</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">snakeEatFoodSound</span><span class="o">.</span><span class="n">play</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">+=</span><span class="mi">1</span>
    <span class="k">def</span> <span class="nf">checkBounds</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">head</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">head</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">head</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
            <span class="k">return</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">head</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">head</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="kc">False</span>        

    <span class="k">def</span> <span class="nf">checkForFood</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">food</span><span class="p">):</span>
        <span class="n">head</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">headTuple</span> <span class="o">=</span> <span class="p">(</span><span class="n">head</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">head</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">foodRect</span> <span class="o">=</span> <span class="n">food</span><span class="o">.</span><span class="n">rect</span>
        <span class="n">collide</span> <span class="o">=</span> <span class="n">foodRect</span><span class="o">.</span><span class="n">collidepoint</span><span class="p">(</span><span class="n">headTuple</span><span class="p">)</span>
        <span class="k">if</span><span class="p">(</span><span class="n">collide</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">eat</span><span class="p">()</span>
            <span class="n">food</span><span class="o">.</span><span class="n">respawn</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">checkTailCollision</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">head</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">hasEatenTail</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">body</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">segment</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">head</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">segment</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">head</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">segment</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                <span class="n">hasEatenTail</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="n">hasEatenTail</span>
<span class="k">class</span> <span class="nc">Food</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Food</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">surf</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;food.png&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">convert_alpha</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">surf</span><span class="o">.</span><span class="n">set_colorkey</span><span class="p">((</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="n">RLEACCEL</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">surf</span><span class="o">.</span><span class="n">get_rect</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">SCREEN_WIDTH</span><span class="p">),</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">SCREEN_HEIGHT</span><span class="p">),))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">speed</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">def</span> <span class="nf">respawn</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">SCREEN_WIDTH</span><span class="o">-</span><span class="mi">50</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">SCREEN_HEIGHT</span><span class="o">-</span><span class="mi">50</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">surf</span><span class="o">.</span><span class="n">get_rect</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,))</span>

<span class="k">class</span> <span class="nc">Level</span><span class="p">():</span>
    <span class="n">currentLevel</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">snekScore</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">levelCode</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">window</span><span class="p">,):</span>
        <span class="k">pass</span>
    <span class="k">def</span> <span class="nf">displayCurrentLevel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">snekLength</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">snekScore</span> <span class="o">=</span> <span class="n">snekLength</span> <span class="o">*</span> <span class="mi">10</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">font</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="s1">&#39;Snek Score: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">snekScore</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; Level: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentLevel</span><span class="p">),</span> <span class="kc">True</span><span class="p">,</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">))</span>
        <span class="n">window</span><span class="o">.</span><span class="n">blit</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">snekScore</span> <span class="o">&gt;=</span> <span class="mi">100</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentLevel</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">levelUP</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">levelUP</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">currentLevel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentLevel</span><span class="o">+</span><span class="mi">1</span>

    <span class="k">def</span> <span class="nf">verifyLevelCode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">levelCode</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">step1LevelCodeBytes</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">levelCode</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exe</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;f&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="n">step1LevelCode</span> <span class="o">=</span> <span class="n">step1LevelCodeBytes</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;ascii&#39;</span><span class="p">)</span>
        <span class="n">step2LevelCode</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">step1LevelCode</span><span class="p">)</span>
        <span class="n">codeSplit</span> <span class="o">=</span> <span class="n">step1LevelCode</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
        <span class="n">step1LevelCodeFirstPart</span> <span class="o">=</span> <span class="n">codeSplit</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">character</span> <span class="ow">in</span> <span class="n">step1LevelCodeFirstPart</span><span class="p">:</span>
            <span class="n">step2LevelCode</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">character</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">step2LevelCode</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">step2LevelCode</span> <span class="o">==</span> <span class="s2">&quot;snekGaem1337&quot;</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;here&quot;</span><span class="p">)</span>
            <span class="n">levelSelector</span> <span class="o">=</span> <span class="n">codeSplit</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;made it&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">currentLevel</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">levelSelector</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exe</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
<span class="n">block_size</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">snake</span> <span class="o">=</span> <span class="n">Snake</span><span class="p">(</span><span class="n">block_size</span><span class="p">,</span> <span class="n">bounds</span><span class="p">)</span>
<span class="c1"># Create the screen object</span>
<span class="c1"># The size is determined by the constant SCREEN_WIDTH and SCREEN_HEIGHT. The function below returns a so called SURFACE which we can draw upon etc.</span>
<span class="n">screen</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">set_mode</span><span class="p">((</span><span class="n">SCREEN_WIDTH</span><span class="p">,</span><span class="n">SCREEN_HEIGHT</span><span class="p">))</span><span class="c1">#We pass a tuple which is why we have double paranthesis</span>

<span class="n">food</span> <span class="o">=</span> <span class="n">Food</span><span class="p">()</span>
<span class="n">font</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">SysFont</span><span class="p">(</span><span class="s1">&#39;comicsans&#39;</span><span class="p">,</span><span class="mi">60</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">level</span> <span class="o">=</span> <span class="n">Level</span><span class="p">(</span><span class="n">font</span><span class="p">,</span> <span class="n">window</span><span class="p">)</span>
<span class="n">level</span><span class="o">.</span><span class="n">currentLevel</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">snakeScore</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">direction</span> <span class="o">=</span> <span class="s1">&#39;right&#39;</span>
<span class="c1">#all_sprites are used for rendering</span>
<span class="n">all_sprites</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Group</span><span class="p">()</span>
<span class="n">all_sprites</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">food</span><span class="p">)</span>
<span class="n">loadSecretTextFileBETA</span><span class="p">(</span><span class="n">level</span><span class="p">)</span>
<span class="c1">#Keep the main game running</span>
<span class="n">running</span> <span class="o">=</span> <span class="kc">True</span>
<span class="c1">#Setup the clcok for a decent framerate</span>
<span class="n">clock</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">Clock</span><span class="p">()</span>
<span class="c1">#Main loop</span>
<span class="k">while</span> <span class="n">running</span><span class="p">:</span>
    <span class="c1">#Look at every event in the event queue</span>
    <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">pygame</span><span class="o">.</span><span class="n">event</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
        <span class="c1">#Did the user hit a key?</span>
        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">KEYDOWN</span><span class="p">:</span>
            <span class="c1">#Which key was it? Was it the escape key?</span>
            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="n">K_ESCAPE</span><span class="p">:</span>
                <span class="n">running</span> <span class="o">=</span> <span class="kc">False</span><span class="c1">#Then we stop the game loop</span>
        <span class="c1">#If the event type is QUIT that means the user closed the window.</span>
        <span class="k">elif</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">QUIT</span><span class="p">:</span>
            <span class="n">running</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">window</span><span class="o">.</span><span class="n">blit</span><span class="p">(</span><span class="n">backgrounds</span><span class="p">[</span><span class="n">level</span><span class="o">.</span><span class="n">currentLevel</span> <span class="o">%</span> <span class="mi">3</span><span class="p">],(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
        <span class="c1"># Draw entities</span>
    <span class="k">for</span> <span class="n">entity</span> <span class="ow">in</span> <span class="n">all_sprites</span><span class="p">:</span>
        <span class="n">screen</span><span class="o">.</span><span class="n">blit</span><span class="p">(</span><span class="n">entity</span><span class="o">.</span><span class="n">surf</span><span class="p">,</span> <span class="n">entity</span><span class="o">.</span><span class="n">rect</span><span class="p">)</span>
    <span class="n">pressed_keys</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">key</span><span class="o">.</span><span class="n">get_pressed</span><span class="p">()</span><span class="c1">#Load pressed keys and compare against specific keys below. These will determine snek direction.</span>
    <span class="k">if</span> <span class="n">pressed_keys</span><span class="p">[</span><span class="n">K_UP</span><span class="p">]:</span>
            <span class="n">snake</span><span class="o">.</span><span class="n">steer</span><span class="p">(</span><span class="n">Direction</span><span class="o">.</span><span class="n">UP</span><span class="p">)</span>
            <span class="n">snakeMoveSound</span><span class="o">.</span><span class="n">play</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">pressed_keys</span><span class="p">[</span><span class="n">K_DOWN</span><span class="p">]:</span>
            <span class="n">snake</span><span class="o">.</span><span class="n">steer</span><span class="p">(</span><span class="n">Direction</span><span class="o">.</span><span class="n">DOWN</span><span class="p">)</span>
            <span class="n">snakeMoveSound</span><span class="o">.</span><span class="n">play</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">pressed_keys</span><span class="p">[</span><span class="n">K_LEFT</span><span class="p">]:</span>
            <span class="n">snake</span><span class="o">.</span><span class="n">steer</span><span class="p">(</span><span class="n">Direction</span><span class="o">.</span><span class="n">LEFT</span><span class="p">)</span>
            <span class="n">snakeMoveSound</span><span class="o">.</span><span class="n">play</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">pressed_keys</span><span class="p">[</span><span class="n">K_RIGHT</span><span class="p">]:</span>
            <span class="n">snake</span><span class="o">.</span><span class="n">steer</span><span class="p">(</span><span class="n">Direction</span><span class="o">.</span><span class="n">RIGHT</span><span class="p">)</span>
            <span class="n">snakeMoveSound</span><span class="o">.</span><span class="n">play</span><span class="p">()</span>
    <span class="n">snake</span><span class="o">.</span><span class="n">move</span><span class="p">()</span>
    <span class="n">snake</span><span class="o">.</span><span class="n">checkForFood</span><span class="p">(</span><span class="n">food</span><span class="p">)</span>
    <span class="n">level</span><span class="o">.</span><span class="n">displayCurrentLevel</span><span class="p">(</span><span class="n">snake</span><span class="o">.</span><span class="n">length</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">snake</span><span class="o">.</span><span class="n">checkBounds</span><span class="p">()</span> <span class="o">==</span> <span class="kc">True</span> <span class="ow">or</span> <span class="n">snake</span><span class="o">.</span><span class="n">checkTailCollision</span><span class="p">()</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span><span class="c1">#Did snek leave the screen or did it collide with itself?</span>
        <span class="n">snekDeathSound</span><span class="o">.</span><span class="n">play</span><span class="p">()</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">font</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="s1">&#39;Snek died :((&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">))</span>
        <span class="n">window</span><span class="o">.</span><span class="n">blit</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">120</span><span class="p">))</span>
        <span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
        <span class="n">pygame</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">delay</span><span class="p">(</span><span class="mi">2500</span><span class="p">)</span>
        <span class="n">level</span><span class="o">.</span><span class="n">currentLevel</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">snake</span><span class="o">.</span><span class="n">respawn</span><span class="p">()</span>
        <span class="n">food</span><span class="o">.</span><span class="n">respawn</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">level</span><span class="o">.</span><span class="n">currentLevel</span> <span class="o">==</span> <span class="mi">99</span><span class="p">:</span><span class="c1">#This is the win condition but it won&#39;t return a flag. </span>
        <span class="n">window</span><span class="o">.</span><span class="n">blit</span><span class="p">(</span><span class="n">victoryImage</span><span class="p">,(</span><span class="mi">120</span><span class="p">,</span><span class="mi">50</span><span class="p">))</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">font</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="s1">&#39;SNEK WON. YOU DID IT!&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">))</span>
        <span class="n">victorySound</span><span class="o">.</span><span class="n">play</span><span class="p">()</span>
        <span class="n">window</span><span class="o">.</span><span class="n">blit</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="p">(</span><span class="mi">150</span><span class="p">,</span><span class="mi">200</span><span class="p">))</span>
        <span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
        <span class="n">pygame</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">delay</span><span class="p">(</span><span class="mi">2500</span><span class="p">)</span>
        <span class="n">running</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">snake</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">pygame</span><span class="p">,</span> <span class="n">window</span><span class="p">)</span>
<span class="c1">#The lines below says &quot;Draw surface onto the screen at the center&quot; effectively drawing a surface on the main surface of the game. blit = block transfer</span>
    <span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">flip</span><span class="p">()</span>
    <span class="c1">#Ensure program maintains a rate of the snake speed, for intance 30 fps.</span>
    <span class="n">clock</span><span class="o">.</span><span class="n">tick</span><span class="p">(</span><span class="n">snakeSpeed</span><span class="p">)</span>
<span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">music</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
<span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">quit</span><span class="p">()</span>
</code></pre></div>

<p>There is a <em>lot</em> of code here, but we quickly see two interesting functions:</p>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">loadSecretTextFileBETA</span><span class="p">(</span><span class="n">level</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">filePointer</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;./secretScoreBETASKIP.txt&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ruhRoh</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;File likely not found.&quot;</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="n">secretCode</span> <span class="o">=</span> <span class="n">filePointer</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
    <span class="c1"># print(secretCode)</span>
    <span class="n">level</span><span class="o">.</span><span class="n">verifyLevelCode</span><span class="p">(</span><span class="n">secretCode</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Level</span><span class="p">():</span>
    <span class="o">...</span>
    <span class="k">def</span> <span class="nf">verifyLevelCode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">levelCode</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">step1LevelCodeBytes</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">levelCode</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exe</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;f&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="n">step1LevelCode</span> <span class="o">=</span> <span class="n">step1LevelCodeBytes</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;ascii&#39;</span><span class="p">)</span>
        <span class="n">step2LevelCode</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">step1LevelCode</span><span class="p">)</span>
        <span class="n">codeSplit</span> <span class="o">=</span> <span class="n">step1LevelCode</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
        <span class="n">step1LevelCodeFirstPart</span> <span class="o">=</span> <span class="n">codeSplit</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">character</span> <span class="ow">in</span> <span class="n">step1LevelCodeFirstPart</span><span class="p">:</span>
            <span class="n">step2LevelCode</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">character</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">step2LevelCode</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">step2LevelCode</span> <span class="o">==</span> <span class="s2">&quot;snekGaem1337&quot;</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;here&quot;</span><span class="p">)</span>
            <span class="n">levelSelector</span> <span class="o">=</span> <span class="n">codeSplit</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;made it&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">currentLevel</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">levelSelector</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exe</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
</code></pre></div>

<p>Searching the source code also verifies that these functions do indeed get called. <code>loadSecretTextFileBETA</code> is called by the main script, <code>Food.verifyLevelCode</code> is called by the former. The first function reads the file <code>secretScoreBETASKIP.txt</code>, and then calls the second function with its content. The second executes a number of steps:</p>
<ul>
<li>
<p>Base64 decodes file contents</p>
</li>
<li>
<p>Split the content by ":"</p>
</li>
<li>
<p>Decrement the char-value of all characters in first string by one</p>
</li>
<li>
<p>Check if the first string equal "snekGaem1337"</p>
</li>
<li>
<p>Load the level designated by the second string</p>
</li>
</ul>
<p>Since we know that we have to get to level 99, forging a payload is trivial:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">base64</span> <span class="kn">import</span> <span class="n">b64encode</span>

<span class="n">seg1</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">chr</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="s2">&quot;snekGaem1337&quot;</span><span class="p">)</span>
<span class="n">seg2</span> <span class="o">=</span> <span class="s2">&quot;99&quot;</span>

<span class="n">skip_code</span> <span class="o">=</span> <span class="n">seg1</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">seg2</span>
<span class="n">skip_code</span> <span class="o">=</span> <span class="n">b64encode</span><span class="p">(</span><span class="n">skip_code</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;secretScoreBETASKIP.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">skip_code</span><span class="p">)</span>
</code></pre></div>

<p>Running this file first, then the game, yields a victory screen. We can now take the base64 encoded string and pass it to the website, to get our flag.</p>
            </div>
        
        
    </div>

    </body>
</html>